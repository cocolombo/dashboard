{% load dashboard_extras %}
<!-- templates/partials/calendar_widget.html -->
<div class="bg-gray-800 rounded-lg p-4 text-white">
    <div class="flex justify-between items-center mb-3">
        <h3 class="text-orange-400 font-bold text-lg">üìÖ {{ month_name }} {{ year }}</h3>
<!-- templates/partials/calendar_widget.html ‚Üí REMPLACE LES 3 BOUTONS -->

<div class="flex gap-3 text-lg">
    <!-- Mois pr√©c√©dent -->
    <button hx-get="?year={{ year }}&month={{ month|add:-1 }}"
            hx-target="#calendar-widget"
            hx-swap="outerHTML"
            class="hover:text-orange-400">‚Üê</button>

    <!-- Aujourd'hui (recharge juste la page Infos compl√®te ‚Üí propre et s√ªr) -->
    <button hx-get="{% url 'index' current_page.slug %}"
            hx-target="#calendar-widget"
            hx-swap="outerHTML"
            class="text-xs text-gray-500 hover:text-orange-400">
        Aujourd'hui
    </button>

    <!-- Mois suivant -->
    <button hx-get="?year={{ year }}&month={{ month|add:1 }}"
            hx-target="#calendar-widget"
            hx-swap="outerHTML"
            class="hover:text-orange-400">‚Üí</button>
</div>

    </div>

    <div class="grid grid-cols-7 text-center text-xs text-gray-400 mb-1">
        <div>L</div><div>M</div><div>M</div><div>J</div><div>V</div><div class="text-orange-400">S</div><div class="text-orange-400">D</div>
    </div>

    <div class="grid grid-cols-7 gap-1 text-sm">
        {% for week in calendar %}
            {% for day in week %}
                {% if day == 0 %}
                    <div></div>
                {% else %}
                    <div class="relative h-10 rounded flex items-center justify-center hover:bg-gray-700 transition
                        {% if day == today.day and month == today.month and year == today.year %} bg-orange-900 font-bold {% endif %}">
                        <span class="{% if day == today.day and month == today.month and year == today.year %} text-white {% else %} text-gray-300 {% endif %}">
                            {{ day }}
                        </span>
                        {% if events_by_day|get_item:day %}
                            <div class="absolute bottom-1 left-1 right-1 flex gap-1 justify-center">
                                {% for event in events_by_day|get_item:day %}
                                    <div class="w-1 h-1 rounded-full" style="background-color: {{ event.color }}" title="{{ event.title }}"></div>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>

    <!-- L√©gende des calendriers (optionnel) -->
    {% if calendars %}
    <div class="mt-3 flex flex-wrap gap-2 text-xs">
        {% for cal in calendars %}
            <span class="flex items-center gap-1">
                <span class="w-2 h-2 rounded-full inline-block" style="background-color: {{ cal.color }}"></span>
                {{ cal.title }}
            </span>
        {% endfor %}
    </div>
    {% endif %}
</div>